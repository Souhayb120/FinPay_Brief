Index: src/main/java/org/example/Paiement.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package org.example;\r\n\r\nimport java.time.LocalDate;\r\n\r\npublic class Paiement {\r\n    private int id;\r\n    private double montant;\r\n    private LocalDate date;\r\n    private int idFacture;\r\n    private String modePaiement;\r\n    public Paiement(){};\r\n\r\n    public Paiement(int id, double montant, LocalDate date, int idFacture,String modePaiement) {\r\n        this.id = id;\r\n        this.montant = montant;\r\n        this.date = date;\r\n        this.idFacture = idFacture;\r\n        this.modePaiement = modePaiement;\r\n    }\r\n\r\n    public int getId() {\r\n        return id;\r\n    }\r\n\r\n    public void setId(int id) {\r\n        this.id = id;\r\n    }\r\n\r\n    public double getMontant() {\r\n        return montant;\r\n    }\r\n\r\n    public void setMontant(double montant) {\r\n        this.montant = montant;\r\n    }\r\n\r\n    public LocalDate getDate() {\r\n        return date;\r\n    }\r\n\r\n    public void setDate(LocalDate date) {\r\n        this.date = date;\r\n    }\r\n\r\n    public int getIdFacture() {\r\n        return idFacture;\r\n    }\r\n\r\n    public void setIdFacture(int idFacture) {\r\n        this.idFacture = idFacture;\r\n    }\r\n\r\n\r\n\r\n    public String getModePaiement() {\r\n        return modePaiement;\r\n    }\r\n\r\n    public void setModePaiement(String modePaiement) {\r\n        this.modePaiement = modePaiement;\r\n    }\r\n\r\n    @Override\r\n    public String toString() {\r\n        return \"Paiement{\" +\r\n                \"id=\" + id +\r\n                \", montant=\" + montant +\r\n                \", date=\" + date +\r\n                \", idFacture=\" + idFacture +\r\n                  +\r\n                '}';\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/org/example/Paiement.java b/src/main/java/org/example/Paiement.java
--- a/src/main/java/org/example/Paiement.java	(revision b52d3ee44c7d1ac24add59fac0340eaf6fbc9fe5)
+++ b/src/main/java/org/example/Paiement.java	(date 1771853995564)
@@ -70,4 +70,7 @@
                   +
                 '}';
     }
+
+    public void setCommission(double v) {
+    }
 }
Index: src/main/java/org/example/Daoclient.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\r\n package org.example;\r\n\r\nimport java.sql.*;\r\nimport java.util.Scanner;\r\n\r\n    public class Daoclient {\r\n        private Scanner sc = new Scanner(System.in);\r\n\r\npublic void ajouterClient(Connection con) throws SQLException {\r\n       System.out.println(\"=========== Ajouter Client ==========\");\r\n            System.out.print(\"Entrer le nom : \");\r\n            String nom = sc.nextLine();\r\n\r\n            System.out.println(\"Entrer solde initial : \");\r\n            double solde_init = sc.nextDouble();\r\n            sc.nextLine();\r\n\r\n            PreparedStatement ps = con.prepareStatement(\"INSERT INTO client(nom, solde_init) VALUES (?, ?)\");\r\n            ps.setString(1, nom);\r\n            ps.setDouble(2, solde_init);\r\n\r\n            ps.executeUpdate();\r\n         System.out.println(\"Client ajouté avec succès !\");\r\n            ps.close();\r\n        }\r\n\r\n        public void supprimerClient(Connection con) throws SQLException {\r\n            System.out.print(\"Entrer l'ID du client à supprimer : \");\r\n            int id = sc.nextInt();\r\n            sc.nextLine();\r\n\r\n            PreparedStatement ps = con.prepareStatement(\"DELETE FROM client WHERE id = ?\");\r\n            ps.setInt(1, id);\r\n            int rows = ps.executeUpdate();\r\n\r\n            if (rows > 0) {\r\n                System.out.println(\"Client supprimé !\");\r\n            } else {\r\n                System.out.println(\"ID introuvable !\");\r\n            }\r\n\r\n            ps.close();\r\n\r\n\r\n        }\r\n\r\n\r\n\r\n        public void modifierClient(Connection con) throws SQLException {\r\n            System.out.print(\"Entrer l'ID du client à modifier : \");\r\n            int id = sc.nextInt();\r\n            sc.nextLine();\r\n\r\n            System.out.print(\"Entrer le nouveau nom : \");\r\n            String nom = sc.nextLine();\r\n\r\n            PreparedStatement ps = con.prepareStatement(\"UPDATE client SET nom=? WHERE id=?\");\r\n            ps.setString(1, nom);\r\n            ps.setInt(2, id);\r\n\r\n\r\n        }\r\n\r\n\r\n        public void listerClient(Connection con) throws SQLException {\r\n            Statement st = con.createStatement();\r\n            ResultSet rs = st.executeQuery(\"SELECT * FROM client\");\r\n\r\n            System.out.println(\"=== Liste des clients ===\");\r\n            while (rs.next()) {\r\n                System.out.println(\"ID: \" + rs.getInt(\"id\") + \", Nom: \" + rs.getString(\"nom\") +\r\n                        \", Solde: \" + rs.getDouble(\"solde_init\"));\r\n            }\r\n\r\n            rs.close();\r\n            st.close();\r\n        }\r\n\r\n\r\n        public void chercherClient(Connection con) throws SQLException {\r\n            System.out.print(\"Entrer l'ID du client à chercher : \");\r\n            int id = sc.nextInt();\r\n            sc.nextLine();\r\n\r\n            PreparedStatement ps = con.prepareStatement(\r\n                    \"SELECT * FROM client WHERE id = ?\"\r\n            );\r\n            ps.setInt(1, id);\r\n\r\n            ResultSet rs = ps.executeQuery();\r\n            if (rs.next()) {\r\n                System.out.println(\"ID: \" + rs.getInt(\"id\") +\r\n                        \", Nom: \" + rs.getString(\"nom\") +\r\n                        \", Solde: \" + rs.getDouble(\"solde_init\"));\r\n            } else {\r\n                System.out.println(\"Client introuvable !\");\r\n            }\r\n\r\n            rs.close();\r\n            ps.close();\r\n        }\r\n    }\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/org/example/Daoclient.java b/src/main/java/org/example/Daoclient.java
--- a/src/main/java/org/example/Daoclient.java	(revision b52d3ee44c7d1ac24add59fac0340eaf6fbc9fe5)
+++ b/src/main/java/org/example/Daoclient.java	(date 1771853995562)
@@ -7,7 +7,7 @@
     public class Daoclient {
         private Scanner sc = new Scanner(System.in);
 
-public void ajouterClient(Connection con) throws SQLException {
+public void ajouterClient(Connection conn) throws SQLException {
        System.out.println("=========== Ajouter Client ==========");
             System.out.print("Entrer le nom : ");
             String nom = sc.nextLine();
@@ -16,7 +16,7 @@
             double solde_init = sc.nextDouble();
             sc.nextLine();
 
-            PreparedStatement ps = con.prepareStatement("INSERT INTO client(nom, solde_init) VALUES (?, ?)");
+            PreparedStatement ps = conn.prepareStatement("INSERT INTO client(nom, solde_init) VALUES (?, ?)");
             ps.setString(1, nom);
             ps.setDouble(2, solde_init);
 
@@ -25,12 +25,12 @@
             ps.close();
         }
 
-        public void supprimerClient(Connection con) throws SQLException {
+        public void supprimerClient(Connection conn) throws SQLException {
             System.out.print("Entrer l'ID du client à supprimer : ");
             int id = sc.nextInt();
             sc.nextLine();
 
-            PreparedStatement ps = con.prepareStatement("DELETE FROM client WHERE id = ?");
+            PreparedStatement ps = conn.prepareStatement("DELETE FROM client WHERE id = ?");
             ps.setInt(1, id);
             int rows = ps.executeUpdate();
 
@@ -47,7 +47,7 @@
 
 
 
-        public void modifierClient(Connection con) throws SQLException {
+        public void modifierClient(Connection conn) throws SQLException {
             System.out.print("Entrer l'ID du client à modifier : ");
             int id = sc.nextInt();
             sc.nextLine();
@@ -55,16 +55,14 @@
             System.out.print("Entrer le nouveau nom : ");
             String nom = sc.nextLine();
 
-            PreparedStatement ps = con.prepareStatement("UPDATE client SET nom=? WHERE id=?");
+            PreparedStatement ps = conn.prepareStatement("UPDATE client SET nom=? WHERE id=?");
             ps.setString(1, nom);
             ps.setInt(2, id);
-
-
+            ps.executeUpdate();
         }
 
-
-        public void listerClient(Connection con) throws SQLException {
-            Statement st = con.createStatement();
+        public void listerClient(Connection conn) throws SQLException {
+            Statement st = conn.createStatement();
             ResultSet rs = st.executeQuery("SELECT * FROM client");
 
             System.out.println("=== Liste des clients ===");
@@ -78,12 +76,12 @@
         }
 
 
-        public void chercherClient(Connection con) throws SQLException {
+        public void chercherClient(Connection conn) throws SQLException {
             System.out.print("Entrer l'ID du client à chercher : ");
             int id = sc.nextInt();
             sc.nextLine();
 
-            PreparedStatement ps = con.prepareStatement(
+            PreparedStatement ps = conn.prepareStatement(
                     "SELECT * FROM client WHERE id = ?"
             );
             ps.setInt(1, id);
Index: src/main/java/org/example/Main.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package org.example;\r\n\r\nimport java.sql.Connection;\r\nimport java.sql.SQLException;\r\nimport java.util.Scanner;\r\n\r\npublic class Main {\r\n\r\n    private static Scanner sc = new Scanner(System.in);\r\n\r\n    public static void main(String[] args) {\r\n\r\n        try (Connection conn = DatabaseConnection.getConnection()) {\r\n            mainMenu(conn);\r\n        } catch (Exception e) {\r\n            System.out.println(\"Erreur connexion DB: \" + e.getMessage());\r\n        }\r\n    }\r\n\r\n    // ================= MAIN MENU =================\r\n    public static void mainMenu(Connection conn) throws SQLException {\r\n\r\n        int choice;\r\n\r\n        do {\r\n            System.out.println(\"\\n=========== FINPAY SYSTEM ===========\");\r\n            System.out.println(\"1. Gestion Prestataires\");\r\n            System.out.println(\"2. Gestion Factures\");\r\n            System.out.println(\"3. Gestion Paiements\");\r\n            System.out.println(\"4. Statistiques\");\r\n            System.out.println(\"5. Gestion Clients\");\r\n            System.out.println(\"0. Quitter\");\r\n            System.out.print(\"Choix: \");\r\n\r\n            choice = sc.nextInt();\r\n            sc.nextLine();\r\n\r\n            switch (choice) {\r\n                case 1 -> prestataireMenu(conn);\r\n                case 2 -> factureMenu(conn);\r\n                case 3 -> paiementMenu(conn);\r\n                case 4 -> statistiquesMenu(conn);\r\n                case 5 -> clientMenu(conn);\r\n                case 0 -> System.out.println(\"Au revoir\");\r\n                default -> System.out.println(\"Choix invalide\");\r\n            }\r\n\r\n        } while (choice != 0);\r\n    }\r\n\r\n    // ================= PRESTATAIRE =================\r\n    public static void prestataireMenu(Connection conn) {\r\n\r\n        PrestataireDao dao = new PrestataireDao();\r\n        int choice;\r\n\r\n        do {\r\n            System.out.println(\"\\n--- MENU PRESTATAIRE ---\");\r\n            System.out.println(\"1. Ajouter\");\r\n            System.out.println(\"2. Supprimer\");\r\n            System.out.println(\"3. Rechercher\");\r\n            System.out.println(\"4. Modifier\");\r\n            System.out.println(\"5. Lister\");\r\n            System.out.println(\"0. Retour\");\r\n            System.out.print(\"Choix: \");\r\n\r\n            choice = sc.nextInt();\r\n            sc.nextLine();\r\n\r\n            switch (choice) {\r\n                case 1 -> dao.ajouterPrestataire(conn);\r\n                case 2 -> dao.suprimerPrestataire(conn);\r\n                case 3 -> dao.recherchPrestataire(conn);\r\n                case 4 -> dao.modifierPrestataire(conn);\r\n                case 5 -> dao.listerPrestataire(conn);\r\n            }\r\n\r\n        } while (choice != 0);\r\n    }\r\n\r\n    // ================= FACTURE =================\r\n    public static void factureMenu(Connection conn) {\r\n\r\n        FactureDao dao = new FactureDao();\r\n        FacturePDFService fg = new FacturePDFService();\r\n\r\n        int choice;\r\n\r\n        do {\r\n            System.out.println(\"\\n--- MENU FACTURE ---\");\r\n            System.out.println(\"1. Ajouter facture\");\r\n            System.out.println(\"2. Supprimer facture\");\r\n            System.out.println(\"3. Rechercher par ID\");\r\n            System.out.println(\"4. Lister factures\");\r\n            System.out.println(\"5. Filtrer par status\");\r\n            System.out.println(\"6. Filtrer par prestataire\");\r\n            System.out.println(\"7. Generer Facture PDF\");\r\n            System.out.println(\"0. Retour\");\r\n            System.out.print(\"Choix: \");\r\n\r\n            choice = sc.nextInt();\r\n            sc.nextLine();\r\n\r\n            switch (choice) {\r\n                case 1 -> {\r\n                    try { dao.ajouterFacture(conn); }\r\n                    catch (Exception e){ System.out.println(e.getMessage()); }\r\n                }\r\n                case 2 -> {\r\n                    try { dao.supprimerFacture(conn); }\r\n                    catch (Exception e){ System.out.println(e.getMessage()); }\r\n                }\r\n                case 3 -> {\r\n                    System.out.print(\"ID: \");\r\n                    int id = sc.nextInt();\r\n                    try { dao.findById(conn,id); }\r\n                    catch (Exception e){ System.out.println(e.getMessage()); }\r\n                }\r\n                case 4 -> {\r\n                    try { dao.listerFacture(conn); }\r\n                    catch (Exception e){ System.out.println(e.getMessage()); }\r\n                }\r\n                case 5 -> {\r\n                    System.out.print(\"Status: \");\r\n                    String status = sc.nextLine();\r\n                    try { dao.filtrerParstatus(conn,status); }\r\n                    catch (Exception e){ System.out.println(e.getMessage()); }\r\n                }\r\n                case 6 -> {\r\n                    System.out.print(\"ID prestataire: \");\r\n                    int idp = sc.nextInt();\r\n                    try { dao.filtrerParPrestataire(conn,idp); }\r\n                    catch (Exception e){ System.out.println(e.getMessage()); }\r\n                }\r\n                case 7 -> {\r\n                    System.out.print(\"ID Facture: \");\r\n                    int idp = sc.nextInt();\r\n\r\n                    try {  fg.genererPDF(conn,idp); }\r\n                    catch (Exception e){ System.out.println(e.getMessage()); }\r\n                }\r\n            }\r\n\r\n        } while (choice != 0);\r\n    }\r\n\r\n    // ================= PAIEMENT =================\r\n    public static void paiementMenu(Connection conn) throws SQLException {\r\n\r\n        PaiementDAO dao = new PaiementDAO();\r\n        int choice;\r\n\r\n        do {\r\n            System.out.println(\"\\n--- MENU PAIEMENT ---\");\r\n            System.out.println(\"1. Ajouter paiement\");\r\n            System.out.println(\"2. Lister paiements\");\r\n            System.out.println(\"3. gérer un paiement partiel\");\r\n            System.out.println(\"4. Update un paiement \");\r\n            System.out.println(\"5. Générer PDF d'un paiement\");\r\n            System.out.println(\"0. Retour\");\r\n            System.out.print(\"Choix: \");\r\n\r\n            choice = sc.nextInt();\r\n            sc.nextLine();\r\n\r\n            switch (choice) {\r\n\r\n                case 1 -> {\r\n                    try {\r\n                        Paiement p = new Paiement();\r\n\r\n                        System.out.print(\"Montant: \");\r\n                        p.setMontant(sc.nextDouble());\r\n                        sc.nextLine();\r\n\r\n                        System.out.print(\"Date (YYYY-MM-DD): \");\r\n                        p.setDate(java.time.LocalDate.parse(sc.nextLine()));\r\n\r\n                        System.out.print(\"ID facture: \");\r\n                        p.setIdFacture(sc.nextInt());\r\n                        sc.nextLine();\r\n\r\n                        System.out.print(\"Mode de paiement: \");\r\n                        p.setModePaiement(sc.nextLine());\r\n\r\n                        dao.save(conn, p);\r\n\r\n                        System.out.println(\"Paiement ajouté ✔\");\r\n\r\n                    } catch (Exception e) {\r\n                        System.out.println(e.getMessage());\r\n                    }\r\n                }\r\n\r\n                case 2 -> {\r\n                    try {\r\n                        for (Paiement p : PaiementDAO.findAll()) {\r\n                            System.out.println(p);\r\n                        }\r\n                    } catch (Exception e) {\r\n                        System.out.println(e.getMessage());\r\n                    }\r\n                }\r\n\r\n                case 3 -> {\r\n                    try {\r\n                        PaiementService paiementService = new PaiementService();\r\n                        paiementService.effectuerPaiementPartiel(conn);\r\n                    } catch (Exception e) {\r\n                        System.out.println(e.getMessage());\r\n                    }\r\n                }\r\n\r\n                case 4 -> {\r\n                    try {\r\n                        PaiementDAO p = new PaiementDAO();\r\n                        p.update(conn, sc);\r\n                    } catch (Exception e) {\r\n                        System.out.println(e.getMessage());\r\n                    }\r\n                }\r\n\r\n                case 5 -> {\r\n                    try {\r\n                        System.out.print(\"Entrez l'ID du paiement pour générer PDF : \");\r\n                        int idPaiement = sc.nextInt();\r\n                        sc.nextLine();\r\n\r\n                        PaiementService.genererPDF(conn, idPaiement);\r\n\r\n                    } catch (Exception e) {\r\n                        System.out.println(\"Erreur lors de la génération du PDF\");\r\n                        e.printStackTrace();\r\n                    }\r\n                }\r\n            }\r\n\r\n        } while (choice != 0);\r\n    }\r\n\r\n    // ================= CLIENT =================\r\n    public static void clientMenu(Connection conn) {\r\n\r\n        Daoclient dao = new Daoclient();\r\n        int choice;\r\n\r\n        do {\r\n            System.out.println(\"\\n--- MENU CLIENT ---\");\r\n            System.out.println(\"1. Ajouter\");\r\n            System.out.println(\"2. Supprimer\");\r\n            System.out.println(\"3. Modifier\");\r\n            System.out.println(\"4. Chercher\");\r\n            System.out.println(\"5. Lister\");\r\n            System.out.println(\"0. Retour\");\r\n            System.out.print(\"Choix: \");\r\n\r\n            choice = sc.nextInt();\r\n            sc.nextLine();\r\n\r\n            switch (choice) {\r\n                case 1 -> {\r\n                    try { dao.ajouterClient(conn); }\r\n                    catch (Exception e){ System.out.println(e.getMessage()); }\r\n                }\r\n                case 2 -> {\r\n                    try { dao.supprimerClient(conn); }\r\n                    catch (Exception e){ System.out.println(e.getMessage()); }\r\n                }\r\n                case 3 -> {\r\n                    try { dao.modifierClient(conn); }\r\n                    catch (Exception e){ System.out.println(e.getMessage()); }\r\n                }\r\n                case 4 -> {\r\n                    try { dao.chercherClient(conn); }\r\n                    catch (Exception e){ System.out.println(e.getMessage()); }\r\n                }\r\n                case 5 -> {\r\n                    try { dao.listerClient(conn); }\r\n                    catch (Exception e){ System.out.println(e.getMessage()); }\r\n                }\r\n            }\r\n\r\n        } while (choice != 0);\r\n    }\r\n\r\n    // ================= STATISTIQUES =================\r\n    public static void statistiquesMenu(Connection conn) {\r\n\r\n        StatistiqueConn scDao = new StatistiqueConn(conn);\r\n        Statistique stats = scDao.getStatistiquesGlobales();\r\n\r\n        System.out.println(\"\\n====== STATISTIQUES ======\");\r\n        System.out.println(\"Total paiements: \" + stats.getTotalPaiements());\r\n        System.out.println(\"Total commissions: \" + stats.getTotalCommissions());\r\n        System.out.println(\"Factures payées: \" + stats.getFacturesPayees());\r\n        System.out.println(\"Factures non payées: \" + stats.getFacturesNonPayees());\r\n        System.out.println(\"Total transactions: \" + stats.getTotalTransactions());\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/org/example/Main.java b/src/main/java/org/example/Main.java
--- a/src/main/java/org/example/Main.java	(revision b52d3ee44c7d1ac24add59fac0340eaf6fbc9fe5)
+++ b/src/main/java/org/example/Main.java	(date 1771853995563)
@@ -1,6 +1,7 @@
 package org.example;
 
 import java.sql.Connection;
+import java.sql.DriverManager;
 import java.sql.SQLException;
 import java.util.Scanner;
 
@@ -29,6 +30,7 @@
             System.out.println("3. Gestion Paiements");
             System.out.println("4. Statistiques");
             System.out.println("5. Gestion Clients");
+            System.out.println("6. Rapport Global Mensuel (Admin) – Excel");// NEW
             System.out.println("0. Quitter");
             System.out.print("Choix: ");
 
@@ -41,6 +43,7 @@
                 case 3 -> paiementMenu(conn);
                 case 4 -> statistiquesMenu(conn);
                 case 5 -> clientMenu(conn);
+                case 6 -> RapportGlobalExcel.excecute();
                 case 0 -> System.out.println("Au revoir");
                 default -> System.out.println("Choix invalide");
             }
@@ -145,7 +148,7 @@
     }
 
     // ================= PAIEMENT =================
-    public static void paiementMenu(Connection conn) throws SQLException {
+    public static void paiementMenu(Connection conn) {
 
         PaiementDAO dao = new PaiementDAO();
         int choice;
@@ -154,9 +157,6 @@
             System.out.println("\n--- MENU PAIEMENT ---");
             System.out.println("1. Ajouter paiement");
             System.out.println("2. Lister paiements");
-            System.out.println("3. gérer un paiement partiel");
-            System.out.println("4. Update un paiement ");
-            System.out.println("5. Générer PDF d'un paiement");
             System.out.println("0. Retour");
             System.out.print("Choix: ");
 
@@ -164,7 +164,6 @@
             sc.nextLine();
 
             switch (choice) {
-
                 case 1 -> {
                     try {
                         Paiement p = new Paiement();
@@ -178,12 +177,12 @@
 
                         System.out.print("ID facture: ");
                         p.setIdFacture(sc.nextInt());
+
+                        System.out.print("Commission: ");
+                        p.setCommission(sc.nextDouble());
                         sc.nextLine();
 
-                        System.out.print("Mode de paiement: ");
-                        p.setModePaiement(sc.nextLine());
-
-                        dao.save(conn, p);
+                        dao.save(conn,p);
 
                         System.out.println("Paiement ajouté ✔");
 
@@ -201,38 +200,6 @@
                         System.out.println(e.getMessage());
                     }
                 }
-
-                case 3 -> {
-                    try {
-                        PaiementService paiementService = new PaiementService();
-                        paiementService.effectuerPaiementPartiel(conn);
-                    } catch (Exception e) {
-                        System.out.println(e.getMessage());
-                    }
-                }
-
-                case 4 -> {
-                    try {
-                        PaiementDAO p = new PaiementDAO();
-                        p.update(conn, sc);
-                    } catch (Exception e) {
-                        System.out.println(e.getMessage());
-                    }
-                }
-
-                case 5 -> {
-                    try {
-                        System.out.print("Entrez l'ID du paiement pour générer PDF : ");
-                        int idPaiement = sc.nextInt();
-                        sc.nextLine();
-
-                        PaiementService.genererPDF(conn, idPaiement);
-
-                    } catch (Exception e) {
-                        System.out.println("Erreur lors de la génération du PDF");
-                        e.printStackTrace();
-                    }
-                }
             }
 
         } while (choice != 0);
@@ -294,6 +261,7 @@
         System.out.println("Total commissions: " + stats.getTotalCommissions());
         System.out.println("Factures payées: " + stats.getFacturesPayees());
         System.out.println("Factures non payées: " + stats.getFacturesNonPayees());
+        System.out.println("Factures Partiel: " + stats.getFacturesPartiel());
         System.out.println("Total transactions: " + stats.getTotalTransactions());
     }
-}
\ No newline at end of file
+}
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"AutoImportSettings\">\r\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\r\n  </component>\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"9a7c870c-73d3-4436-bd08-837f6d32f797\" name=\"Changes\" comment=\"\">\r\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/facture_1.pdf\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/facture_1.pdf\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/java/org/example/FacturePDFService.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/java/org/example/FacturePDFService.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/java/org/example/Main.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/java/org/example/Main.java\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"FileTemplateManagerImpl\">\r\n    <option name=\"RECENT_TEMPLATES\">\r\n      <list>\r\n        <option value=\"Class\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <excluded-from-favorite>\r\n      <branch-storage>\r\n        <map>\r\n          <entry type=\"LOCAL\">\r\n            <value>\r\n              <list>\r\n                <branch-info repo=\"$PROJECT_DIR$\" source=\"main\" />\r\n              </list>\r\n            </value>\r\n          </entry>\r\n        </map>\r\n      </branch-storage>\r\n    </excluded-from-favorite>\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n  </component>\r\n  <component name=\"GitHubPullRequestSearchHistory\">{\r\n  &quot;lastFilter&quot;: {\r\n    &quot;state&quot;: &quot;OPEN&quot;,\r\n    &quot;assignee&quot;: &quot;NihadHub&quot;\r\n  }\r\n}</component>\r\n  <component name=\"GithubPullRequestsUISettings\">{\r\n  &quot;selectedUrlAndAccountId&quot;: {\r\n    &quot;url&quot;: &quot;https://github.com/Souhayb120/FinPay_Brief&quot;,\r\n    &quot;accountId&quot;: &quot;f4ec0a33-9598-40fd-8dbc-8c65e4610a38&quot;\r\n  }\r\n}</component>\r\n  <component name=\"ProjectColorInfo\">{\r\n  &quot;customColor&quot;: &quot;&quot;,\r\n  &quot;associatedIndex&quot;: 2\r\n}</component>\r\n  <component name=\"ProjectId\" id=\"39kMhJdGQ4CXOfbz7QPbRPlJZyy\" />\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\"><![CDATA[{\r\n  \"keyToString\": {\r\n    \"Application.Main.executor\": \"Run\",\r\n    \"ModuleVcsDetector.initialDetectionPerformed\": \"true\",\r\n    \"RunOnceActivity.ShowReadmeOnStart\": \"true\",\r\n    \"RunOnceActivity.TerminalTabsStorage.copyFrom.TerminalArrangementManager.252\": \"true\",\r\n    \"RunOnceActivity.git.unshallow\": \"true\",\r\n    \"git-widget-placeholder\": \"main\",\r\n    \"ignore.virus.scanning.warn.message\": \"true\",\r\n    \"kotlin-language-version-configured\": \"true\",\r\n    \"last_opened_file_path\": \"C:/Users/Administrator/Desktop/new/FinPay_Brief\",\r\n    \"project.structure.last.edited\": \"Libraries\",\r\n    \"project.structure.proportion\": \"0.15\",\r\n    \"project.structure.side.proportion\": \"0.2\"\r\n  }\r\n}]]></component>\r\n  <component name=\"RunManager\">\r\n    <configuration name=\"Main\" type=\"Application\" factoryName=\"Application\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"org.example.Main\" />\r\n      <module name=\"FinPay_Brief\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"org.example.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <recent_temporary>\r\n      <list>\r\n        <item itemvalue=\"Application.Main\" />\r\n      </list>\r\n    </recent_temporary>\r\n  </component>\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\r\n      <changelist id=\"9a7c870c-73d3-4436-bd08-837f6d32f797\" name=\"Changes\" comment=\"\" />\r\n      <created>1771235733919</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1771235733919</updated>\r\n    </task>\r\n    <servers />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision b52d3ee44c7d1ac24add59fac0340eaf6fbc9fe5)
+++ b/.idea/workspace.xml	(date 1771854317126)
@@ -5,10 +5,15 @@
   </component>
   <component name="ChangeListManager">
     <list default="true" id="9a7c870c-73d3-4436-bd08-837f6d32f797" name="Changes" comment="">
-      <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/facture_1.pdf" beforeDir="false" afterPath="$PROJECT_DIR$/facture_1.pdf" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/src/main/java/org/example/FacturePDFService.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/org/example/FacturePDFService.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/.idea/.name" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/rapportglobalmois.xlsx" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/org/example/RapportGlobalExcel.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/org/example/Daoclient.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/org/example/Daoclient.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/org/example/DatabaseConnection.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/org/example/DatabaseConnection.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/org/example/FactureDao.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/org/example/FactureDao.java" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/src/main/java/org/example/Main.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/org/example/Main.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/org/example/Paiement.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/org/example/Paiement.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/org/example/PrestataireDao.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/org/example/PrestataireDao.java" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -66,7 +71,7 @@
     "RunOnceActivity.ShowReadmeOnStart": "true",
     "RunOnceActivity.TerminalTabsStorage.copyFrom.TerminalArrangementManager.252": "true",
     "RunOnceActivity.git.unshallow": "true",
-    "git-widget-placeholder": "main",
+    "git-widget-placeholder": "Merging main",
     "ignore.virus.scanning.warn.message": "true",
     "kotlin-language-version-configured": "true",
     "last_opened_file_path": "C:/Users/Administrator/Desktop/new/FinPay_Brief",
Index: src/main/java/org/example/FactureDao.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package org.example;\r\n\r\nimport java.sql.*;\r\nimport java.time.LocalDate;\r\nimport java.util.Scanner;\r\n\r\npublic class FactureDao {\r\n    private Scanner sc =new Scanner(System.in);\r\n    public void ajouterFacture(Connection con)throws SQLException{\r\n        System.out.println(\"===Ajouter Facture====\");\r\n        System.out.println(\"Entrer id prestataire :\");\r\n        int idPrestataire = sc.nextInt();\r\n        System.out.println(\"Entrer id client :\");\r\n        int idClient = sc.nextInt();\r\n        System.out.println(\"Entrer montant :\");\r\n        double montant = sc.nextDouble();\r\n        System.out.println(\"Entrer montant total :\");\r\n        double totalMontant = sc.nextDouble();\r\n        //calcul status\r\n        String status;\r\n        if(montant==0){\r\n            status=\"Non payée\";\r\n        } else if (totalMontant>montant) {\r\n            status=\"Partiel\";\r\n        }else {\r\n            status=\"Payée\";\r\n        }\r\n      try(PreparedStatement ps = con.prepareStatement(\"INSERT INTO facture(date_facture,status,id_client,id_prestataire,montant_total,montant) VALUES(?,?,?,?,?,?)\")) {\r\n          ps.setDate(1, Date.valueOf(LocalDate.now()));\r\n          ps.setString(2, status);\r\n          ps.setInt(3, idClient);\r\n          ps.setInt(4, idPrestataire);\r\n          ps.setDouble(5, totalMontant);\r\n          ps.setDouble(6, montant);\r\n          ps.executeUpdate();\r\n          System.out.println(\"Ajouter facture success\");\r\n      }\r\n    }\r\n\r\n    public void supprimerFacture(Connection con)throws SQLException{\r\n        System.out.println(\"===Suprimer un Facture ===\");\r\n        System.out.println(\"Entrer id supprimer\");\r\n        int id=sc.nextInt();\r\n        sc.nextLine();\r\n       try(PreparedStatement ps = con.prepareStatement(\"DELETE FROM facture where id =?\")) {\r\n           ps.setInt(1,id);\r\n           int sup = ps.executeUpdate();\r\n           if (sup > 0) {\r\n               System.out.println(\"Facture est supprimer\");\r\n           } else {\r\n               System.out.println(\"Aucun facture de supprimer \");\r\n           }\r\n       }\r\n    }\r\n\r\n    public static Facture findById(Connection con, int id)throws SQLException {\r\n        PreparedStatement ps = con.prepareStatement(\"SELECT * FROM facture WHERE id = ?  \");\r\n        ps.setInt(1, id);\r\n        ResultSet rs = ps.executeQuery();\r\n        if (rs.next()) {\r\n\r\n            int factureId = rs.getInt(\"id\");\r\n            LocalDate dateFacture = rs.getDate(\"date_facture\").toLocalDate();\r\n            String status = rs.getString(\"status\");\r\n            int idClient = rs.getInt(\"id_client\");\r\n            int idPrestataire = rs.getInt(\"id_prestataire\");\r\n\r\n            System.out.println(\"ID : \" + factureId);\r\n            System.out.println(\"Date : \" + dateFacture);\r\n            System.out.println(\"Status : \" + status);\r\n            System.out.println(\"Id Client : \" + idClient);\r\n            System.out.println(\"Id Prestataire : \" + idPrestataire);\r\n\r\n        }\r\n        return null;\r\n    }\r\n\r\n    public void modifierFactureAuto(Connection con, int id, double total, double montant, String status, int idClient, int idPrestataire) throws SQLException {\r\n        try (PreparedStatement ps = con.prepareStatement(\"UPDATE facture SET montant_total=?, montant=?, status=?, id_client=?, id_prestataire=? WHERE id=?\")) {\r\n            ps.setDouble(1, total);\r\n            ps.setDouble(2, montant);\r\n            ps.setString(3, status);\r\n            ps.setInt(4, idClient);\r\n            ps.setInt(5, idPrestataire);\r\n            ps.setInt(6, id);\r\n            ps.executeUpdate();\r\n        }\r\n    }\r\n\r\n    public void listerFacture(Connection con )throws SQLException{\r\n        System.out.println(\"====Afficher Facture=====\");\r\n      try (PreparedStatement ps= con.prepareStatement(\"SELECT * FROM facture\")) {\r\n\r\n          ResultSet rs = ps.executeQuery();\r\n          while (rs.next()) {\r\n              System.out.println(\"id\" + rs.getInt(\"id\"));\r\n              System.out.println(\"status\" + rs.getString(\"status\"));\r\n              System.out.println(\"Date\" + rs.getDate(\"date_facture\"));\r\n              System.out.println(\"id client\" + rs.getInt(\"id_client\"));\r\n              System.out.println(\"id prestataire\" + rs.getInt(\"id_prestataire\"));\r\n          }\r\n      }\r\n    }\r\n\r\n    public void filtrerParstatus(Connection con ,String status)throws SQLException{\r\n     try(PreparedStatement ps =con.prepareStatement(\"SELECT * FROM facture WHERE status=?\")) {\r\n        ps.setString(1,status);\r\n        ResultSet rs = ps.executeQuery();\r\n         System.out.println(\" Filtrer status facture est \"+status);\r\n        while (rs.next()){\r\n            System.out.println(\"ID\"+rs.getInt(\"id\"));\r\n            System.out.println(\"Status\"+rs.getString(\"status\"));\r\n            System.out.println(\"Client id\"+rs.getInt(\"id_client\"));\r\n            System.out.println(\"Prestataire id\"+rs.getInt(\"id_prestataire\"));\r\n        }\r\n     }\r\n    }\r\n\r\n    public void filtrerParPrestataire(Connection con ,int idPrestataire)throws SQLException{\r\n        try(PreparedStatement ps =con.prepareStatement(\"SELECT  * FROM facture WHERE id_prestataire=?\")){\r\n            ps.setInt(1,idPrestataire);\r\n            System.out.println(\"Filtrer prestataire est :\"+idPrestataire);\r\n            ResultSet rs =ps.executeQuery();\r\n            while (rs.next()){\r\n                System.out.println(\"ID\"+rs.getInt(\"id\"));\r\n                System.out.println(\"Status\"+rs.getString(\"status\"));\r\n                System.out.println(\"Client id\"+rs.getInt(\"id_client\"));\r\n                System.out.println(\"Date facture\"+rs.getDate(\"date_facture\"));\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    public static double getMontantTotal(Connection con, int idFacture) throws SQLException {\r\n        String sql = \"SELECT montant_total FROM facture WHERE id = ?\";\r\n        try (PreparedStatement ps = con.prepareStatement(sql)) {\r\n            ps.setInt(1, idFacture);\r\n            ResultSet rs = ps.executeQuery();\r\n            if (rs.next()) {\r\n                return rs.getDouble(\"montant_total\");\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/org/example/FactureDao.java b/src/main/java/org/example/FactureDao.java
--- a/src/main/java/org/example/FactureDao.java	(revision b52d3ee44c7d1ac24add59fac0340eaf6fbc9fe5)
+++ b/src/main/java/org/example/FactureDao.java	(date 1771854317070)
@@ -6,7 +6,10 @@
 
 public class FactureDao {
     private Scanner sc =new Scanner(System.in);
-    public void ajouterFacture(Connection con)throws SQLException{
+
+
+
+    public void ajouterFacture(Connection conn)throws SQLException{
         System.out.println("===Ajouter Facture====");
         System.out.println("Entrer id prestataire :");
         int idPrestataire = sc.nextInt();
@@ -25,24 +28,24 @@
         }else {
             status="Payée";
         }
-      try(PreparedStatement ps = con.prepareStatement("INSERT INTO facture(date_facture,status,id_client,id_prestataire,montant_total,montant) VALUES(?,?,?,?,?,?)")) {
-          ps.setDate(1, Date.valueOf(LocalDate.now()));
-          ps.setString(2, status);
-          ps.setInt(3, idClient);
-          ps.setInt(4, idPrestataire);
-          ps.setDouble(5, totalMontant);
-          ps.setDouble(6, montant);
+      try(PreparedStatement ps = conn.prepareStatement("INSERT INTO facture(status,date_facture,montant,montant_total,id_client,id_prestataire) VALUES(?,?,?,?,?,?)")) {
+          ps.setString(1, status);
+          ps.setDate(2, Date.valueOf(LocalDate.now()));
+          ps.setDouble(3, montant);
+          ps.setDouble(4, totalMontant);
+          ps.setInt(5, idClient);
+          ps.setInt(6, idPrestataire);
           ps.executeUpdate();
           System.out.println("Ajouter facture success");
       }
     }
 
-    public void supprimerFacture(Connection con)throws SQLException{
+    public void supprimerFacture(Connection conn)throws SQLException{
         System.out.println("===Suprimer un Facture ===");
         System.out.println("Entrer id supprimer");
         int id=sc.nextInt();
         sc.nextLine();
-       try(PreparedStatement ps = con.prepareStatement("DELETE FROM facture where id =?")) {
+       try(PreparedStatement ps = conn.prepareStatement("DELETE FROM facture where id =?")) {
            ps.setInt(1,id);
            int sup = ps.executeUpdate();
            if (sup > 0) {
@@ -53,8 +56,8 @@
        }
     }
 
-    public static Facture findById(Connection con, int id)throws SQLException {
-        PreparedStatement ps = con.prepareStatement("SELECT * FROM facture WHERE id = ?  ");
+    public static Facture findById(Connection conn, int id)throws SQLException {
+        PreparedStatement ps = conn.prepareStatement("SELECT * FROM facture WHERE id = ?  ");
         ps.setInt(1, id);
         ResultSet rs = ps.executeQuery();
         if (rs.next()) {
@@ -75,8 +78,8 @@
         return null;
     }
 
-    public void modifierFactureAuto(Connection con, int id, double total, double montant, String status, int idClient, int idPrestataire) throws SQLException {
-        try (PreparedStatement ps = con.prepareStatement("UPDATE facture SET montant_total=?, montant=?, status=?, id_client=?, id_prestataire=? WHERE id=?")) {
+    public void modifierFactureAuto(Connection conn, int id, double total, double montant, String status, int idClient, int idPrestataire) throws SQLException {
+        try (PreparedStatement ps = conn.prepareStatement("UPDATE facture SET montant_total=?, montant=?, status=?, id_client=?, id_prestataire=? WHERE id=?")) {
             ps.setDouble(1, total);
             ps.setDouble(2, montant);
             ps.setString(3, status);
@@ -87,23 +90,22 @@
         }
     }
 
-    public void listerFacture(Connection con )throws SQLException{
+    public void listerFacture(Connection conn )throws SQLException{
         System.out.println("====Afficher Facture=====");
-      try (PreparedStatement ps= con.prepareStatement("SELECT * FROM facture")) {
+      try (PreparedStatement ps= conn.prepareStatement("SELECT * FROM facture")) {
 
           ResultSet rs = ps.executeQuery();
           while (rs.next()) {
-              System.out.println("id" + rs.getInt("id"));
-              System.out.println("status" + rs.getString("status"));
-              System.out.println("Date" + rs.getDate("date_facture"));
-              System.out.println("id client" + rs.getInt("id_client"));
-              System.out.println("id prestataire" + rs.getInt("id_prestataire"));
+              System.out.println("id " + rs.getInt("id"));
+              System.out.println("status " + rs.getString("status"));
+              System.out.println("Date " + rs.getDate("date_facture"));
+              System.out.println("id client " + rs.getInt("id_client"));
+              System.out.println("id prestataire " + rs.getInt("id_prestataire"));
           }
       }
     }
-
-    public void filtrerParstatus(Connection con ,String status)throws SQLException{
-     try(PreparedStatement ps =con.prepareStatement("SELECT * FROM facture WHERE status=?")) {
+    public void filtrerParstatus(Connection conn ,String status)throws SQLException{
+     try(PreparedStatement ps =conn.prepareStatement("SELECT * FROM facture WHERE status=?")) {
         ps.setString(1,status);
         ResultSet rs = ps.executeQuery();
          System.out.println(" Filtrer status facture est "+status);
@@ -116,8 +118,8 @@
      }
     }
 
-    public void filtrerParPrestataire(Connection con ,int idPrestataire)throws SQLException{
-        try(PreparedStatement ps =con.prepareStatement("SELECT  * FROM facture WHERE id_prestataire=?")){
+    public void filtrerParPrestataire(Connection conn ,int idPrestataire)throws SQLException{
+        try(PreparedStatement ps =conn.prepareStatement("SELECT  * FROM facture WHERE id_prestataire=?")){
             ps.setInt(1,idPrestataire);
             System.out.println("Filtrer prestataire est :"+idPrestataire);
             ResultSet rs =ps.executeQuery();
@@ -130,17 +132,4 @@
         }
 
     }
-
-    public static double getMontantTotal(Connection con, int idFacture) throws SQLException {
-        String sql = "SELECT montant_total FROM facture WHERE id = ?";
-        try (PreparedStatement ps = con.prepareStatement(sql)) {
-            ps.setInt(1, idFacture);
-            ResultSet rs = ps.executeQuery();
-            if (rs.next()) {
-                return rs.getDouble("montant_total");
-            }
-        }
-        return 0;
-    }
-
 }
Index: src/main/java/org/example/DatabaseConnection.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\r\n\r\npackage org.example;\r\n\r\nimport java.sql.Connection;\r\nimport java.sql.DriverManager;\r\nimport java.sql.SQLException;\r\n\r\npublic class DatabaseConnection {\r\n    private static final String URL = \"jdbc:mysql://localhost:3306/finpay\";\r\n    private static final String USER = \"root\";\r\n    private static final String PASSWORD = \"\";\r\n\r\n    public static Connection getConnection() throws SQLException {\r\n        return DriverManager.getConnection(URL, USER, PASSWORD);\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/org/example/DatabaseConnection.java b/src/main/java/org/example/DatabaseConnection.java
--- a/src/main/java/org/example/DatabaseConnection.java	(revision b52d3ee44c7d1ac24add59fac0340eaf6fbc9fe5)
+++ b/src/main/java/org/example/DatabaseConnection.java	(date 1771853995562)
@@ -11,6 +11,7 @@
     private static final String USER = "root";
     private static final String PASSWORD = "";
 
+
     public static Connection getConnection() throws SQLException {
         return DriverManager.getConnection(URL, USER, PASSWORD);
     }
Index: src/main/java/org/example/PrestataireDao.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package org.example;\r\n\r\n\r\nimport java.sql.Connection;\r\n\r\nimport java.sql.PreparedStatement;\r\nimport java.sql.ResultSet;\r\nimport java.util.Scanner;\r\n\r\npublic class PrestataireDao {\r\n    private Scanner sc=new Scanner(System.in);\r\n\r\n    public void ajouterPrestataire(Connection con) {\r\n        System.out.println(\"===Ajouter un prestataire ===\");\r\n        System.out.println(\"Entrer le nom :\");\r\n        String nom=sc.nextLine();\r\n        System.out.println(\"Entrer l'adress\");\r\n        String adress= sc.nextLine();\r\n        try (PreparedStatement ps = con.prepareStatement(\"insert into prestataire  (nom,adress) VALUES(?,?)\")){\r\n            ps.setString(1,nom);\r\n            ps.setString(2,adress);\r\n            ps.executeUpdate();\r\n            System.out.println(\"Ajouter Prestataire succes !\");\r\n        }catch(Exception e){\r\n            System.out.println(\"Error\"+e.getMessage());\r\n        }\r\n    }\r\n    public void suprimerPrestataire(Connection con){\r\n        System.out.println(\"===Suprimer un Prestataire ===\");\r\n        System.out.println(\"Entrer id supprimer\");\r\n        int id=sc.nextInt();\r\n        sc.nextLine();\r\n        try(PreparedStatement ps= con.prepareStatement(\"DELETE From Prestataire WHERE id =?\")) {\r\n            ps.setInt(1,id);\r\n            int remove=ps.executeUpdate();\r\n            if (remove>0){\r\n                System.out.println(\"Prestataire est suprimé !\");\r\n            }else {\r\n                System.out.println(\"Aucun prestataire pour suprimer\");\r\n            }\r\n\r\n        }catch (Exception e){\r\n            System.out.println(\"Error\"+e.getMessage());\r\n        }\r\n    }\r\n    public void recherchPrestataire(Connection con){\r\n        System.out.println(\"===Rechercher un Prestataire ===\");\r\n        System.out.println(\"Entrer id de recherche : \");\r\n        int id = sc.nextInt();\r\n        try(PreparedStatement ps = con.prepareStatement(\"SELECT  * FROM prestataire WHERE id =?\")) {\r\n          ps.setInt(1,id);\r\n            ResultSet st=ps.executeQuery();\r\n            if(st.next()){\r\n                System.out.println(\"Id :\"+st.getInt(\"id\"));\r\n                System.out.println(\"Nom :\"+st.getString(\"nom\"));\r\n                System.out.println(\"Adress :\"+st.getString(\"adress\"));\r\n            }else {\r\n                System.out.println(\"Aucun prestataire\");\r\n            }\r\n\r\n        }catch (Exception e){\r\n            System.out.println(\"Erreur\"+e.getMessage());\r\n        }\r\n    }\r\n    public void modifierPrestataire(Connection con){\r\n        System.out.println(\"===Modifier un Prestataire ===\");\r\n        System.out.println(\"Entrer l'id de modifier :\");\r\n        int id=sc.nextInt();\r\n        sc.nextLine();\r\n        System.out.println(\"Entrer le nom modifier : \");\r\n        String nom= sc.nextLine();\r\n        System.out.println(\"Entrer l'adress modifier :\");\r\n        String adress=sc.nextLine();\r\n        try(PreparedStatement ps= con.prepareStatement(\"UPDATE Prestataire SET nom = ? , adress = ? WHERE id =?\")) {\r\n            ps.setString(1,nom);\r\n            ps.setString(2,adress);\r\n           ps.setInt(3,id);\r\n            int mod =ps.executeUpdate();\r\n            if(mod>0){\r\n                System.out.println(\"Modifier success !!\");\r\n            }else {\r\n                System.out.println(\"Aucun prestataire pour modifier\");\r\n            }\r\n        }catch (Exception e){\r\n            System.out.println(\"Erreur \"+e.getMessage());\r\n        }\r\n\r\n    }\r\n    public void listerPrestataire(Connection con){\r\n        System.out.println(\"===Lister un Prestataire ===\");\r\n        try(PreparedStatement ps= con.prepareStatement(\"SELECT * FROM Prestataire\")) {\r\n           ResultSet rs = ps.executeQuery();\r\n           while (rs.next()){\r\n               System.out.println(\"Id :\"+rs.getInt(\"id\"));\r\n               System.out.println(\"Nom :\"+rs.getString(\"nom\"));\r\n               System.out.println(\"Adress :\"+rs.getString(\"adress\"));\r\n           }\r\n\r\n        }catch (Exception e){\r\n            System.out.println(\"Erreur\"+e.getMessage());\r\n        }\r\n\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/org/example/PrestataireDao.java b/src/main/java/org/example/PrestataireDao.java
--- a/src/main/java/org/example/PrestataireDao.java	(revision b52d3ee44c7d1ac24add59fac0340eaf6fbc9fe5)
+++ b/src/main/java/org/example/PrestataireDao.java	(date 1771853995564)
@@ -5,18 +5,19 @@
 
 import java.sql.PreparedStatement;
 import java.sql.ResultSet;
+import java.sql.SQLException;
 import java.util.Scanner;
 
 public class PrestataireDao {
     private Scanner sc=new Scanner(System.in);
 
-    public void ajouterPrestataire(Connection con) {
+    public void ajouterPrestataire(Connection conn) {
         System.out.println("===Ajouter un prestataire ===");
         System.out.println("Entrer le nom :");
         String nom=sc.nextLine();
         System.out.println("Entrer l'adress");
         String adress= sc.nextLine();
-        try (PreparedStatement ps = con.prepareStatement("insert into prestataire  (nom,adress) VALUES(?,?)")){
+        try (PreparedStatement ps = conn.prepareStatement("insert into prestataire  (nom,adress) VALUES(?,?)")){
             ps.setString(1,nom);
             ps.setString(2,adress);
             ps.executeUpdate();
@@ -25,12 +26,12 @@
             System.out.println("Error"+e.getMessage());
         }
     }
-    public void suprimerPrestataire(Connection con){
+    public void suprimerPrestataire(Connection conn){
         System.out.println("===Suprimer un Prestataire ===");
         System.out.println("Entrer id supprimer");
         int id=sc.nextInt();
         sc.nextLine();
-        try(PreparedStatement ps= con.prepareStatement("DELETE From Prestataire WHERE id =?")) {
+        try(PreparedStatement ps= conn.prepareStatement("DELETE From Prestataire WHERE id =?")) {
             ps.setInt(1,id);
             int remove=ps.executeUpdate();
             if (remove>0){
@@ -43,11 +44,11 @@
             System.out.println("Error"+e.getMessage());
         }
     }
-    public void recherchPrestataire(Connection con){
+    public void recherchPrestataire(Connection conn){
         System.out.println("===Rechercher un Prestataire ===");
         System.out.println("Entrer id de recherche : ");
         int id = sc.nextInt();
-        try(PreparedStatement ps = con.prepareStatement("SELECT  * FROM prestataire WHERE id =?")) {
+        try(PreparedStatement ps = conn.prepareStatement("SELECT  * FROM prestataire WHERE id =?")) {
           ps.setInt(1,id);
             ResultSet st=ps.executeQuery();
             if(st.next()){
@@ -62,7 +63,7 @@
             System.out.println("Erreur"+e.getMessage());
         }
     }
-    public void modifierPrestataire(Connection con){
+    public void modifierPrestataire(Connection conn){
         System.out.println("===Modifier un Prestataire ===");
         System.out.println("Entrer l'id de modifier :");
         int id=sc.nextInt();
@@ -71,7 +72,7 @@
         String nom= sc.nextLine();
         System.out.println("Entrer l'adress modifier :");
         String adress=sc.nextLine();
-        try(PreparedStatement ps= con.prepareStatement("UPDATE Prestataire SET nom = ? , adress = ? WHERE id =?")) {
+        try(PreparedStatement ps= conn.prepareStatement("UPDATE Prestataire SET nom = ? , adress = ? WHERE id =?")) {
             ps.setString(1,nom);
             ps.setString(2,adress);
            ps.setInt(3,id);
@@ -86,9 +87,9 @@
         }
 
     }
-    public void listerPrestataire(Connection con){
+    public void listerPrestataire(Connection conn){
         System.out.println("===Lister un Prestataire ===");
-        try(PreparedStatement ps= con.prepareStatement("SELECT * FROM Prestataire")) {
+        try(PreparedStatement ps= conn.prepareStatement("SELECT * FROM Prestataire")) {
            ResultSet rs = ps.executeQuery();
            while (rs.next()){
                System.out.println("Id :"+rs.getInt("id"));
Index: src/main/java/org/example/RapportGlobalExcel.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/org/example/RapportGlobalExcel.java b/src/main/java/org/example/RapportGlobalExcel.java
new file mode 100644
--- /dev/null	(date 1771853995564)
+++ b/src/main/java/org/example/RapportGlobalExcel.java	(date 1771853995564)
@@ -0,0 +1,69 @@
+package org.example;
+
+import org.apache.poi.ss.usermodel.*;
+import org.apache.poi.xssf.usermodel.XSSFWorkbook;
+
+import java.io.FileOutputStream;
+import java.io.IOException;
+import java.sql.*;
+
+public class RapportGlobalExcel {
+
+    public static void excecute() throws SQLException {
+        Connection conn = DatabaseConnection.getConnection();
+
+        System.out.println("le fichier  est cree ");
+
+        String sql = "SELECT DATE_FORMAT(facture.date_facture, '%Y-%m') AS mois,\n" +
+                " prestataire.nom AS prestataire,\n" +
+                "COUNT(facture.id) AS nombre_factures,\n " +
+                "SUM(facture.montant_total) AS total_genere,\n " +
+                "SUM(facture.montant_total)*0.02 AS total_commission \n" +
+                "FROM prestataire \n" +
+                "JOIN facture ON facture.id_prestataire = prestataire.id \n" +
+                "GROUP BY DATE_FORMAT(facture.date_facture,'%Y-%m'), prestataire.nom \n" +
+                "ORDER BY mois;\n";
+        PreparedStatement ps = conn.prepareStatement(sql);
+
+        ResultSet rs = ps.executeQuery();
+        //xlsx file
+        Workbook workbook = new XSSFWorkbook();
+        //name of the sheet
+        Sheet sheet = workbook.createSheet("Rapport Global");
+
+        // HEADER
+        Row headerRow = sheet.createRow(0); // 0 is the index of the first row
+        String[] headers = {"mois", "Prestataire", "Nombre Factures", "Total Généré", "Total Commissions"};
+        //style
+        CellStyle headerStyle = workbook.createCellStyle();
+        Font boldFont = workbook.createFont();
+        boldFont.setBold(true);// make font bold
+        headerStyle.setFont(boldFont);
+        for (int i = 0; i < headers.length; i++) {
+            Cell cell = headerRow.createCell(i);
+            cell.setCellValue(headers[i]);
+            cell.setCellStyle(headerStyle);
+            sheet.setColumnWidth(i, 8000);
+        }
+        //DATA
+        int rowsIndex = 1;
+        while (rs.next()) {
+            Row row = sheet.createRow(rowsIndex++);
+            row.createCell(0).setCellValue(rs.getString("mois"));
+            row.createCell(1).setCellValue(rs.getString("prestataire"));
+            row.createCell(2).setCellValue(rs.getInt("nombre_factures"));
+            row.createCell(3).setCellValue(rs.getDouble("total_genere"));
+            row.createCell(4).setCellValue(rs.getDouble("total_commission"));
+        }
+        try {
+            FileOutputStream fileOutputStream = new FileOutputStream("rapportglobalmois.xlsx");
+            workbook.write(fileOutputStream);
+            workbook.close();
+            fileOutputStream.close();
+        } catch (Exception e) {
+            e.printStackTrace();
+        }
+    }
+
+}
+
Index: .idea/.name
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/.name b/.idea/.name
new file mode 100644
--- /dev/null	(date 1771853995560)
+++ b/.idea/.name	(date 1771853995560)
@@ -0,0 +1,1 @@
+Main.java
\ No newline at end of file
